https://github.com/lc/gau
# Set-Up

> [!NOTE] How To Use This Section
> Gather as many in-scope URLs as possible. You should finish this section with 2 groups: URLs returning 200s and URLs returning 400s. At the end they will be placed in an EyeWitness scan.
> 
> Take note of any identified entry points / flows to test for input handling vulnerabilities later.

## Emails And Accounts
Likely you will need accounts for testing. It is useful to have 2 or even 3 burner emails on hand. The first email will be used to initially create an account used for enumeration. The others will be used for registration and permissions testing. Sign up for an account in the application and identify the session tokens used.
## Initial Application Scans
### Burp Scan

> If the app is an SPA only using APIs, scanning will be conducted later for this case.

- Login and record authentication to application with Burp. 
- Run a generic scan against the base of the application, ensuring that cookies from the cookie jar are used. 
### ZAP Scan
to do...

## Functionality
> Continue to enumerate functionality as you run tools and scans on the application.

Manually browse the site and familiarise yourself with the functionality of the site and therefore the necessary components. Some examples are:
* Configurable Objects
* File Upload
* Comments
* User Profile Configuration
* Submitting Links
* Language Change
* Search Box
List the general functionalities of the application and take notes about each.



# Stack Enumeration

> [!NOTE] How To Use This Subsection
> Identifying the stack will help identify the programming language used and hidden content the server will likely have. Try to identify the programming language in use by the application and try to compile a framework specific word list for hidden content files to use in the next section. It is also important to identify stack components to research public CVEs for them.

`whatweb` can help identify application stack components:
```
whatweb https://target.xyz
```

Identify a WAF in use. This may explain 403 responses returned from the application. If there are many 403s, identify a valid bypass technique. Once you find a bypass for one endpoint the WAF is blocking, this bypass will likely work for all endpoints the WAF is blocking:
```
wafw00f https://target.xyz
```
## Language & Extension Fuzzing
```
ffuf -u https://target.xyz/index.FUZZ -w C:\Wordlists\Seclists\Discovery\Web-Content\raft-large-extensions.txt  -of json  -o IndexExtension.fuzzout.json
```
## Headers From Different Response Codes
#### 200s
Inspect the HTTP headers from a 200 response code:
```
curl https://target.xyz -I
```
#### 300s
Attempt to identify a 300 redirect request using `ffuf`. No need to output these as JSON as they will not be used:
```
fuff -u http://target.xyz/FUZZ -w <Directory Wordlist Path> -fc 300-399 
ffuf -w <Directory Wordlist Path>:DIR -w <File Wordlist Path>:FILE -u http://target.xyz/DIR/FILE --mode clusterbomb
```
Then obtain the response headers and body
```
curl http://target.xyz/redirect
curl http://target.xyz/redirect -I
```
#### 400s
Request an invalid path and make a malformed request to extract 404 and 401 error codes:
```
curl http://target.xyz/%
curl http://target.xyz/% -I
curl http://target.xyz/non/existant/path
curl http://target.xyz/non/existant/path -I
```
#### 500s
Finally, identify input points to server side processing. Attempt to supply invalid parameter values to break application logic and extract a response in the 500s:
```
curl http://target.xyz/sqrt?num=0
curl http://target.xyz/sqrt?num=0 -I
```
## Cookie Inspection
Run the following command to inspect cookies used by the application:
```
curl https://target.xyz -I
```
Compare the cookie value to this table to see if the stack can be revealed:

| Framework         | Cookie name                       |
| ----------------- | --------------------------------- |
| Zope              | zope3                             |
| CakePHP           | cakephp                           |
| Kohana            | kohanasession                     |
| Laravel           | laravel_session                   |
| phpBB             | phpbb3_                           |
| WordPress         | wp-settings                       |
| 1C-Bitrix         | BITRIX_                           |
| AMPcms            | AMP                               |
| Django CMS        | django                            |
| DotNetNuke        | DotNetNukeAnonymous               |
| e107              | e107_tz                           |
| EPiServer         | EPiTrace, EPiServer               |
| Graffiti CMS      | graffitibot                       |
| Hotaru CMS        | hotaru_mobile                     |
| ImpressCMS        | ICMSession                        |
| Indico            | MAKACSESSION                      |
| InstantCMS        | InstantCMS[logdate]               |
| Kentico CMS       | CMSPreferredCulture               |
| MODx              | SN4[12symb]                       |
| TYPO3             | fe_typo_user                      |
| Dynamicweb        | Dynamicweb                        |
| LEPTON            | lep[some_numeric_value]+sessionid |
| Wix               | Domain=.wix.com                   |
| VIVVO             | VivvoSessionId                    |
| Tiny File Manager | filemanager                       |
| Zenphoto          | zenphoto_auth                     |
## Google Dorking
```
site:target.xyz "Powered by"
site:target.xyz "Stack trace"
site:target.xyz "Exception"
site:target.xyz "Error at"
```
## CMS Enumeration
First `<meta name="generator">` tags should be checked in the HTLM source code:
```
curl -s https://target.com | grep -i '<meta[^>]*name=["'\'']generator["'\'']'
```

> If a CMS has not been identified, run `cmsseek.py`, choose option 1: "CMS detection and Deep scan", and enter the base URL of the target. If nothing was found, use all of tools listed in this subsection to attempt to identify a CMS. It does not mean one is not in use if you don't identify one here!

Run `cmsseek.py`:
```
python3 cmsseek.py
```
https://github.com/dionach/CMSmap will test for general CMSs also
https://github.com/Tuhinshubhra/CMSeeK
```
nuclei -u https://target.xyz -tags cms,wordpress,joomla,drupal,magento,ghost,typo3,prestashop,opencart,shopify,wix,squarespace 
```
### Fuzzing For CMS

> This subsection is in level 3 of the Hidden Content and URL Enumeration section in the Fuzzing subsection. If a CMS has not been identified and stack information is scarce, be sure to complete all 3 levels of the Fuzzing subsection.
## Source Code Enumeration
### Pulling All Source Code
Clone the entire application locally:
```
httrack https://target.xyz -O ./local-clone --mirror
```
#### HTLM Tags
Run this from `local-clone/..`:
```
grep -RinE '<meta[^>]+name=["'"'"']generator["'"'"']|<body[^>]+id=["'"'"']phpbb["'"'"']|DNN Platform' ./local-clone/
```

| Application | Keyword                                                                        |
| ----------- | ------------------------------------------------------------------------------ |
| WordPress   | `<meta name="generator" content="WordPress 3.9.2" />`                          |
| phpBB       | `<body id="phpbb"`                                                             |
| Mediawiki   | `<meta name="generator" content="MediaWiki 1.21.9" />`                         |
| Joomla      | `<meta name="generator" content="Joomla! - Open Source Content Management" />` |
| Drupal      | `<meta name="Generator" content="Drupal 7 (https://drupal.org)" />`            |
| DotNetNuke  | `DNN Platform - [https://www.dnnsoftware.com](https://www.dnnsoftware.com)`    |
#### HTML Comments
Run this from `local-clone/..`:
```
grep -RinE '<!-- START headerTags\.cfm|__VIEWSTATE|<!-- ZK|<!-- BC_OBNW -->|ndxz-studio' ./local-clone/
```

| Framework         | Keyword                     |
| ----------------- | --------------------------- |
| Adobe ColdFusion  | `<!-- START headerTags.cfm` |
| Microsoft ASP.NET | `__VIEWSTATE`               |
| ZK                | `<!-- ZK`                   |
| Business Catalyst | `<!-- BC_OBNW -->`          |
| Indexhibit        | `ndxz-studio`               |
## Library Enumeration
Run this from `local-clone/..` to extract all script tags:
```
grep -RohE '<script[^>]+src=["'"'"'][^"'"'"']+' ./local-clone/ | sed -E 's/.*src=["'"'"']([^"'"'"']+)/\1/' | sort -u

```

Extract JS and CSS asset paths  from all pages to extract all script tags `local-clone/..`:
```
grep -RohE '(src|href)=["'"'"'][^"'"'"']+\.(js|css)' ./local-clone/ | sed -E 's/.*(src|href)=["'"'"']([^"'"'"']+)/\2/' | sort -u
```

Extra checks to be ran from `local-clone/..`:
```
grep -RinE 'jquery|wordpress|drupal|joomla|bootstrap|react|vue|angular|webpack' ./local-clone/
```
## Scanning With OWASP Dependancy Check
```
dependancy-check --scan ./local-clone
```
## Credential Enumeration
#### Additional JavaScript Scans
```
mkdir jsurls
katana -u https://target.xyz -jc -o jsurls/urls.txt
trufflehog filesystem jsurls/urls.txt
```
#### Google Dorking For JavaScript
```
site:target.xyz ext:js
site:target.xyz inurl:js
```
#### Hunting In Client-Side Source Code
```
trufflehog filesystem ./local-clone
```
#### Check Inside JWTs
Decode the payload of the JWT (the middle payload between the dots).






# Hidden Content And URL Enumeration
## Spidering
https://github.com/lc/gau
Use `gau` from AlienVault to identify URLs:
```
gau https://target.xyz > urls.gau.txt
```
Run katana:
```
katana -u https://target.xyz -jc -jsl -kf all -o urls.katana.txt
```

### robots.txt
https://github.com/0xPugal/LinkHunter/tree/master
### sitemap.xml
```
SitemapExtract.exe https://target.xml > .\urls.sitemap.txt
SitemapExtract.exe .\LocalSiteMap.xml > .\urls.sitemap.txt
```
### ParamSpider
```
paramspider -d target.xyz
```
## Fuzzing

> If lots of information regarding the stack and sitemap have already been enumerated, stop fuzzing at which ever level feels necessary. If not much information was identified, and definitely if a CMS was not identified, complete ***ALL 3 LEVELS*** of  this subsection. Fuzz the application as much as possible.

> ***Pro Tip:*** For each directory command, repeat the command but with a -e with an extension that the web application uses or most likely extension.
### Level 1
#### API Documentation
Generic directory and file fuzzing. If `AllListsUniq.txt` does not exist, create it with the first line:
```
cd SecLists/Discovery/Web-Content && cat *.txt > AllListsCombined.txt && sort AllListsCombined.txt | uniq > AllListsUniq.txt -H "Cookie: session=abc123"
ffuf -u https://target.xyz -w AllListsUniq.txt -o directory.fuzz.out -recursion -of json -o directories.fuzzout.json -H "Cookie: session=abc123"
```
Using the directories identified the application, fuzz for files within the application:
```
ffuf -u https://target.xyz/FUZZ -w SecLists/Discovery/Web-Content/raft-medium-directories.txt -e .php,.asp,.aspx,.jsp,.js,.json,.txt,.bak,.old,.zip -recursion -of json -o files.fuzzout.json -H "Cookie: session=abc123" -recursion

ffuf -u https://target.xyz/FUZZ -w All-Wordlists\login-file-locations\cfm.txt  -of json -o files1.fuzzout.json -H "Cookie: session=abc123" 

ffuf -u https://target.xyz/FUZZ -w SecLists/Discovery/Web-Content/raft-medium-files.txt  -of json -o files2.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ1/FUZZ2FUZZ3 -w SecLists/Discovery/Web-Content/raft-medium-words.txt:FUZZ1 -w SecLists/Discovery/Web-Content/raft-medium-words.txt:FUZZ2 -w All-Wordlists\filename-dirname-bruteforce\raft-medium-extensions.txt:FUZZ2 -of json -o files2.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w All-Wordlists\login-file-locations\html.txt  -of json -o files3.fuzzout.json -H "Cookie: session=abc123"
```
Run a fuzz for admin panels:
```
ffuf -u https://target.xyzFUZZ -w C:\Wordlists\AdminPanels.txt -of json -o AdminPanels.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w All-Wordlists\login-file-locations\Logins.txt  -of json -o Logins.fuzzout.json -H "Cookie: session=abc123"
```

Fuzz for server metafiles. If a server was identified via earlier enumeration, identify a word list either in `SecLists\Discovery\Web-Content\Web-Servers` or `SecLists\Discovery\Web-Content\Domino-Hunter` or online which is for the server in use and fuzz that. If the server in use is unknown, iterate and fuzz with all the word lists in the `SecLists\Discovery\Web-Content\Web-Servers` and `SecLists\Discovery\Web-Content\Domino-Hunter` directories. Use the following template:
```
ffuf -u https://target.xyz -w <Server Wordlist> -of json -o metafiles.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz -w All-Wordlists\password-file-locations\Passwords.txt -of json -o metafiles1.fuzzout.json  -H "Cookie: session=abc123"
```

Also fuzz for metafiles with this custom wordlist:
```
ffuf -u https://target.xyzFUZZ -w C:\Wordlists\Metafiles.txt -of json -o C:\Wordlists\metafiles.fuzzout.json -H "Cookie: session=abc123"
```

Fuzz for uploads directory:
```
ffuf -u https://target.xyz/FUZZ -w All-Wordlists\filename-dirname-bruteforce\upload_variants.txt -of json -o C:\Wordlists\uploaddir.fuzzout.json -H "Cookie: session=abc123"
```
### Level 2
#### More Directories
```
ffuf -u https://target.xyz/FUZZ -w Wordlists\All-Wordlists\dir.txt -recursion -of json -o files.fuzzout.json -H "Cookie: session=abc123" -recursion

ffuf -u https://target.xyz/FUZZ -w Wordlists\All-Wordlists\fuzz.txt -recursion -of json -o files.fuzzout.json -H "Cookie: session=abc123" -recursion
```
#### More Files
```
ffuf -u https://target.xyz/FUZZ -w SecLists/Discovery/Web-Content/raft-large-directories.txt -e .php,.asp,.aspx,.jsp,.js,.json,.txt,.bak,.old,.zip -recursion -of json -o files.fuzzout.json -H "Cookie: session=abc123" -recursion

ffuf -u https://target.xyz/FUZZ -w SecLists/Discovery/Web-Content/raft-large-files.txt  -of json -o files2.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ1/FUZZ2FUZZ3 -w SecLists/Discovery/Web-Content/raft-large-words.txt:FUZZ1 -w SecLists/Discovery/Web-Content/raft-large-words.txt:FUZZ2 -w All-Wordlists\filename-dirname-bruteforce\raft-large-extensions.txt:FUZZ2 -of json -o files2.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w Wordlists\All-Wordlists\god.txt -of json -o files.fuzzout.json -H "Cookie: session=abc123" -recursion
```
#### Programming Language Specific Fuzzing
##### ASP.NET
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\ASP.NET\CommonBackdoors-ASP.fuzz.txt  -of json -o asp.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\ASP.NET\ELMAH-Debugger.txt -of json -o asp1.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w All-Wordlists\login-file-locations\windows-asp.txt  -of json -o asp2.fuzzout.json -H "Cookie: session=abc123"
```
##### ASPX
```
ffuf -u https://target.xyz/FUZZ -w All-Wordlists\login-file-locations\windows-aspx.txt  -of json -o aspx.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w All-Wordlists\aspx.txt  -of json -o aspx1.fuzzout.json -H "Cookie: session=abc123"
```

##### Java Spring Boot
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\Java-Spring-Boot.txt -of json -o springboot.fuzzout.json -H "Cookie: session=abc123"
```
##### JSP
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\CommonBackdoors-JSP.fuzz.txt -of json -o jsp.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w All-Wordlists\login-file-locations\jsp.txt  -of json -o jsp1.fuzzout.json -H "Cookie: session=abc123"
```
##### PHP
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\CommonBackdoors-PHP.fuzz.txt  -of json -o php.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\Common-PHP-Filenames.txt -of json -o php1.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\PHP.fuzz.txt -of json -o php2.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w All-Wordlists\login-file-locations\php.txt  -of json -o php3.fuzzout.json -H "Cookie: session=abc123"
```
##### Ruby On Rails
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\ror.txt -of json -o ror.fuzzout.json -H "Cookie: session=abc123"
```
##### Pearl
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\CommonBackdoors-PL.fuzz.txt -of json -o pearl.fuzzout.json -H "Cookie: session=abc123"
```
##### GO
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\Programming-Language-Specific\golang.txt -of json -o go.fuzzout.json -H "Cookie: session=abc123"
```
##### CGI
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\LEGACY-SERVICES\CGIs\CGIs.txt  -of json -o cgi.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\LEGACY-SERVICES\CGIs\CGI-XPlatform.fuzz.txt -of json -o cgi1.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\LEGACY-SERVICES\CGIs\CGI-Microsoft.fuzz.txt -of json -o cgi2.fuzzout.json -H "Cookie: session=abc123"
```
### Level 3
##### CMS Fuzzing
Iterate through all the lists within the `SecLists\Discovery\Web-Content\CMS` and `C:\Tools\Wordlists\SecLists\Discovery\Web-Content\URLs`, and `C:\Tools\Wordlists\All-Wordlists\cms` directories. The following command template can be used. Remember to increment X in the output file name:
```
ffuf -u https://target.xyz/FUZZ -w <CMS Wordlist> -of json -o cmsX.fuzzout.json -H "Cookie: session=abc123"
```

##### Different Languages
If the application is in a different language, it is recommended to find wordlists in the correct language. Some examples are as follows:
###### Dutch
```
ffuf -u https://target.xyz/FUZZ -of json -o dutch.fuzzout.json -H "Cookie: session=abc123"
```
##### Service Specific
Iterate through all the lists within the `SecLists\Discovery\Web-Content\Service-Specific`, and `C:\Tools\Wordlists\All-Wordlists\webservers-appservers` directories. The following command template can be used. Remember to increment X in the output file name:
```
ffuf -u https://target.xyz/FUZZ -w <Service Specific Wordlist> -of json -o ServiceSpecficX.fuzzout.json -H "Cookie: session=abc123"
```
##### Typically Disallowed By Robots
```
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\trickest-robots-disallowed-wordlists\top-100.txt -of json -o robotsDisallowed.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\trickest-robots-disallowed-wordlists\top-1000.txt -of json -o robotsDisallowed1.fuzzout.json -H "Cookie: session=abc123"
ffuf -u https://target.xyz/FUZZ -w SecLists\Discovery\Web-Content\trickest-

robots-disallowed-wordlists\top-10000.txt -of json -o robotsDisallowed2.fuzz\.json -H "Cookie: session=abc123"
```
##### Forgotten Copied Files
```
ffuf -u https://target.xyz/FUZZ1FUZZ2 -w All-Wordlists\filename-dirname-bruteforce\copy_of.txt:FUZZ1 -w All-Wordlists\filename-dirname-bruteforce\raft-medium-filenames.txt:FUZZ2 -of json -o copiedFiles.fuzzout.json -H "Cookie: session=abc123"
```
##### Forgotten Files
```
ffuf -u https://target.xyz/FUZZ1.FUZZ2 -w All-Wordlists\filename-dirname-bruteforce\ -of json -o forgottenFiles.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ1.FUZZ2 -w All-Wordlists\filename-dirname-bruteforce\raft-large-words.txt:FUZZ1 -w All-Wordlists\filename-dirname-bruteforce\raft-large-extensions.txt:FUZZ2  -of json -o forgottenFiles2.fuzzout.json -H "Cookie: session=abc123"

ffuf -u https://target.xyz/FUZZ1.FUZZ2 -w All-Wordlists\filename-dirname-bruteforce\raft-large-words.txt:FUZZ1 -w SecLists\Discovery\Web-Content\web-extensions-big.txt:FUZZ2  -of json -o forgottenFiles3.fuzzout.json -H "Cookie: session=abc123"
```
## Dorking
Google dork for web content:
```
site:target.xyz inurl:admin
site:target.xyz inurl:login
site:target.xyz inurl:dashboard
site:target.xyz inurl:api
site:target.xyz inurl:debug
site:target.xyz inurl:test
```
Google dork for backup files:
```
site:target.xyz ext:bak
site:target.xyz ext:old
site:target.xyz ext:backup
site:target.xyz ext:zip
site:target.xyz ext:tar
site:target.xyz ext:sql
site:target.xyz ext:log
```
Google dork for configs and secrets:
```
site:target.xyz ext:env
site:target.xyz ext:yml
site:target.xyz ext:yaml
site:target.xyz ext:json
site:target.xyz ext:conf
site:target.xyz ext:ini
site:target.xyz ext:js
site:target.xyz inurl:js
```
Google dork for admin panels:
```
site:target.xyz inurl:admin
site:target.xyz inurl:manage
site:target.xyz inurl:internal
site:target.xyz inurl:staff
site:target.xyz inurl:secure
```
Google dork for cached content:
```
cache:target.xyz/admin
```




# API Enumeration
## Fuzz For API Documentation
### Fuzzing
Enumerate API documentation endpoints with the following command:
```
ffuf -u http://target.xyzFUZZ -w C:\Wordlists\ApiDocumentation.txt -recursion -of json -o apidocs.fuzzout.json -H "Cookie: session=abc123"

ffuf -u http://target.xyzFUZZ -w SecLists\Discovery\Web-Content\Service-Specific\Swagger.txt -of json -o swagger.fuzzout.json -H "Cookie: session=abc123"
```
### Dorking
Google dork for application API documentation:
```
site:target.xyz inurl:/api
site:target.xyz inurl:/v1
site:target.xyz inurl:/v2
site:target.xyz inurl:swagger
site:target.xyz inurl:openapi
```
## Fuzzing For Hidden API Endpoints
Use KiteRunner to fuzz efficiently for endpoints:
```
kr scan https://target.xyz -A apiroutes-230528
kr scan https://target.xyz -A routes.kite
kr scan https://target.xyz -A routes-small.kite
kr scan https://target.xyz -A routes-large.kite
```
Run a fuzz for the existence of API bases:
```
ffuf -u http://target.xyzFUZZ1 -w C:\Wordlists\ApiBases.txt:FUZZ1  -of json -o apiBases.fuzzout.json -H "Cookie: session=abc123"
```
Run a fuzz for API bases and verbs:
```
ffuf -u http://target.xyzFUZZ1/FUZZ2 -w C:\Wordlists\ApiBases.txt:FUZZ1 -w C:\Wordlists\ApiVerbs.txt:FUZZ2 -of json -o apiEndpoints.fuzzout.json -H "Cookie: session=abc123"
```

### Dorking
```
site:target.xyz inurl:/api
```
### In JavaScript
To do... 
Extract API endpoints from JavaScript.




# Application Scans Revisited
## Review Initial Scans
### Initial Scan Checks
Review scans set up at the start of enumeration with Burp and ZAP. See if session timeouts expired and if token management is necessary within the scanning tool.
## API Scans
> Only run the scans outlined in this subsection if a swagger file or WSDL file or some form of machine readable API docs were identified.
#### Set Up Token Automation
https://github.com/Tib3rius/Collector
If documentation was obtained, use this to scan the APIs with Burp. If APIs use tokens which timeout, token management will be necessary. This is where the collector Burp extension comes in. After installing the extension:

Navigate to the ***Collector*** tab:
- Click the ***+*** button in the top bar and enter a name into the box such as ***TokenBucket***.
- Set the ***Max Size*** option to ***1***. This is the total number of tokens that can be stored in the bucket.
- Set the ***When Bucket is full*** option to ***Replace latest token***.
Navigate to the ***Token Collection*** tab:
- Under collection tools keep only Repeater, 
#### Run Scan
Navigate to dashboard and set up an API scan. Provide the swagger file.








# Identifying URLs Of Interest
## Convert GETs In Swagger & WSDL To URLS
To do... 
## Combining Fuzzed And Spidered URLs
```
jq -s 'add' *.fuzzout.json > allfiles.fuzzout.json

jq -r '.[] | select(.status == 200) | .url' allfiles.fuzzout.json > urls.200.txt

jq -r '.[] | select(.status == 403) | .url' allfiles.fuzzout.json > urls.403.txt

jq -r '.[] | select(.status != 200 and .status != 403) | "\(.status) - \(.url) - \(.input.FUZZ)"' allfiles.fuzzout.json

cat urls.200.txt urls.katana.txt urls.gau.txt urls.sitemap.txt > urls.all.200.txt
```
## Eyewitness
```
eyewitness -f urls.all.200.txt --web -d eyewitness.all.200 --headless --threads 10 --custom-headers "Cookie: session=abc123" --ignore-ssl
```
## Attempting 403 Bypasses
### Fuzzing

> Alternatively you can use Burp

```
DN='target.xyz' && sed "s/<domain name>/$DN/g" C:\Wordlists\RPHeaderValuesREPLACE.txt > RPHeaderValues.txt

ffuf -u https://target.xyz/URIENC -X VERB -H 'HEADER: VALUE'  -H "Cookie: session=abc123" -w urls.403.txt:URI -w C:\Wordlists\403BypassURLEncodings:ENC -w C:\Wordlists\HTTPVerbs.txt:VERB -w C:\Wordlists\RPAuthBypassHeaders.txt:HEADER -w RPHeaderValues.txt:VALUE
```








# Entry Point Enumeration
## Identifying Parameters
> If entry points appear to be scarce after level 1, move onto level 2.
> If a piece of functionality looks interesting but appears to have no vulnerable parameters, come back here and move to level 2 and fuzz for paramters.
### Level 1
#### Browsing
Surf the site and identify interesting functionality and interesting entry points. Make a note of each interesting entry point and obtain request files for each very interesting entry point request.
#### Google Dorking
```
site:target.xyz inurl:?
site:target.xyz inurl:id=
site:target.xyz inurl:token=
site:target.xyz inurl:redirect=
site:target.xyz inurl:return=
site:target.xyz inurl:debug=
```
### Level 2
#### Fuzzing 
Fuzz for parameters in requests that were identified as interesting but do not appear to have vulnerable parameters:
```
ffuf -u https://target.xyz/fileUpload?numberOfFiles=1&bytesPerFile=1024&FUZZ=1 -H 'Cookie: xyz=123' -w SecLists\Discovery\Web-Content\burp-parameter-names.txt
```







# Nuclei & Nikto
General enumeration scans:
```
nuclei -u https://target.xyz -tags tech,panel,exposure,discovery,misconfig,fingerprint,wordpress,wp-plugin,wp-theme -H 'Cookie: <Cookie>=<Value>'

nikto -h https://target.xyz -Tuning 01234ac
```
### General Exploitation
```
nuclei -u http://target.xyz -tags cve,vuln,rce,eval,sqli,xss,lfi,ssrf,xxe,auth,auth-bypass,csrf,redirect,injection,kev,vkev -H 'Cookie: <Cookie>=<Value>'

nikto -h https://target.xyz -Tuning 0123456789abcde
```
### Stack Specific Nuclei Templates
|Tag|Example purpose|
|---|---|
|`apache`|Apache web server detection|
|`nginx`|NGINX detection|
|`iis`|IIS server detection|
|`tomcat`|Apache Tomcat|
|`wordpress`|WordPress core|
|`drupal`|Drupal CMS|
|`joomla`|Joomla CMS|
|`magento`|Magento platform|
|`php`|PHP detection|
|`java`|Java platform|
|`python`|Python backend|

### SQLi
Run a scan using the SQLi template set to enumerate SQLi:
```
nuclei -u http://target.xyz -tags sqli -output nikto.sqli.txt -H 'Cookie: <Cookie>=<Value>'
nikto -h https://target.xyz -Tuning 59
```
### XSS
Run a scan using the XSS template set to enumerate XSS:
```
nuclei -u http://target.xyz -tags xss -output nikto.xss.txt -H 'Cookie: <Cookie>=<Value>'
nikto -h https://target.xyz -Tuning 5
```
### Authentication & Authorisation
Run a scan using the Authentication & Authorisation template set to enumerate Authentication & Authorisation:
```
nuclei -u http://target.xyz -tags auth,auth-bypass -output nikto.auth.txt -H 'Cookie: <Cookie>=<Value>'
nikto -h https://target.xyz -Tuning 6
```
### RCE
Run a scan using the RCE template set to enumerate RCE:
```
nuclei -u http://target.xyz -tags rce -output nikto.rce.txt -H 'Cookie: <Cookie>=<Value>'
nikto -h https://target.xyz -Tuning 8
```
### File Inclusion & Path Traversal
Run a scan using the RCE template set to enumerate RCE:
```
nuclei -u http://target.xyz -tags rce -H 'Cookie: <Cookie>=<Value>'
nikto -h https://target.xyz -Tuning 07
```

