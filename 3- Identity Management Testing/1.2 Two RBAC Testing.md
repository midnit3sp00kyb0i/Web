
> [!NOTE] How To Use This Section
> This section can be used in 4 contexts:
>-  If only a low privileged user is accessible.
>- If two low privileged users are accessible.
>- If a low privileged user and an administrator are accessible.
>- If two low privileged users and an administrator are accessible.
>
> The General Tests section should be completed regardless of the context and using all the information available to you. For instance if IDs of objects belonging to other accounts would aid testing and you have access to other accounts, use them.
# Entry Point Identification
For each accessible user context, identify all requests that carry out things on behalf of the current user. This would be performing actions and creating objects. Make a note of each one that should be tested. Good places to look are within functionality such as:
- Registration
- Login
- Commenting
- Sharing
- Share


# Main Tests
## Site Testing  & API Testing
### Client-Side Authorization Enforcement

**Examples:**
- Disabled buttons
- Hidden UI elements
- Role checks in JS only
###### Check
Ensure that the endpoint the hidden element calls to does not enforce access control.
**Exploit:**  
Identify endpoints which those hidden elements make calls to and talk to them directly.
#### Missing Function-Level Access Control
There may be more endpoints that do not enforce access control, and just aren't called by access control enforcing client side JavaScript. **Attempt to make requests to all other enumerated endpoints and try to perform actions you shouldn't be able to**. If you feel  you should enumerate more, here they are
#### For Site Testing
```
kr scan https://target.xyz -A raft-large-directories.txt
```
#### For API Testing
```
kr scan https://target.xyz -A apiroutes-230528
```
### HTTP Verb Tampering, Headers, And Encoding Bypasses
https://github.com/undefinedCody/TamperMAP.git
Fuzz all enumerated endpoints with verb tampering, bypass headers, bypass values and bad encodings:
```
ffuf -u https://target.xyz/URIENC -X VERB -H 'HEADER: VALUE'  -H "Cookie: session=abc123" -w urls.403.txt:URI -w C:\Wordlists\403BypassURLEncodings:ENC -w C:\Wordlists\HTTPVerbs.txt:VERB -w C:\Wordlists\RPAuthBypassHeaders.txt:HEADER -w RPHeaderValues.txt:VALUE
```
Attempt to authenticate with HTTP headers such as the following:
```
X-User: admin
X-User: <username>
X-Role: staff
```
### Referer Bypass
App checks `Referer` header for authorization.
**Exploit:**
```http
Referer: https://target.xyz/admin
```
### Insecurely Trusted Parameters
Examine all parameters on each entry point to check for insecurely passed parameters that identify the user. Parameters may be named such as `user`, `group`, `id`, etc. If no parameters can be identified with these names the following methods can be applied. If they are identified attempt to pass a different user ID if any have been identified or a generic one such as `admin`, `administrator`, `root`, etc.

Use `arjun` to identify hidden paramters:
```
arjun -u https://api.example.com/endpoint -m (GET|POST|XML|JSON)
```

Fuzz  for potentially vulnerable parameter names with below word list:
```
ffuf -u https://target.xyz/entry/point?FUZZ=<username> -H 'Cookies: xyz=123' -w 
```

```
user
group
id
whoami
u
g
identity
```

Also Google dork for parameters:
```
site:target.xyz inurl:user=
site:target.xyz inurl:group=
site:target.xyz inurl:id=
site:target.xyz inurl:whoami=
site:target.xyz inurl:u=
site:target.xyz inurl:g=
site:target.xyz inurl:identity=
```
### Parameter Pollution Bypass
To do...
### Mass Assignment Bypass
**API-specific**
**What it is:**  
Extra JSON fields are accepted and mapped automatically.
**Example request:**
```json
{
  "email": "user@x.com",
  "isAdmin": true
}
```
### Role Confusion / Role Mixing
**Logic bug**
**What it is:**  
Users have multiple roles, and checks are inconsistent.
**Example:**
```text
User has role=viewer but can POST admin actions
```
### Broken Container Isolation (Multi-Tenant Apps)
**What it is:**  
Users can access resources across containers and tenants.
**Examples:**
```text
/container/User1container/dashboard
/container/User1container/dashboard

/tennant1/conatiner1/dashboard
/tennant2/conatiner1/dashboard
```
### IDORs
Identify where objects are referenced via an ID. This vulnerability is most often present in integer IDs, however, developers may have implemented predictable UUIDs. Entry points that can be vulnerable IDORs are single endpoints that are used to access many resources that are identified via passing a parameter. Once a potentially vulnerable entry point and parameter are identified, if integer, try incrementing the value, decrementing the value, 0, and negative numbers. If it is with UUIDs, try incrementing the last character, decrementing the last character, a NULL ID, or known IDs previously identified (if any).

If parameter is vulnerable, run the following command to fuzz:
```
seq 0 255 | ffuf -w - -u http://target.xyz/api/user?id=FUZZ -H 'Cookie: xyz=123'
```
### File Access Bypass
**What it is:**  
Files protected by path only.
**Examples:**
```text
/download?file=admin.pdf
/reports/secret.xls
```
### Multi Step Authorisation Bypass
**High-impact logic flaw**
**What it is:**  
Authorization checked in step 1 but not later steps.
**Example:**
```text
Step 1: /checkout
Step 2: /checkout/confirm
```
Skip step 1 → reach step 2 directly.
### JWT Bypasses
To do...
```
jwt_tool token.txt -I
```
### OAuth Bypasses
- **Missing / skipped authorization check** → **Authorization bypass**
- **Access token not bound to user / client** → **Authorization bypass**
- **Token substitution (using another user’s token)** → **Authorization bypass**
- **Overly broad scopes / scope ignored** → **Authorization bypass**
- **Client-side trust of OAuth response** → **Authorization bypass**
- **Token introspection not enforced / cached incorrectly** → **Authorization bypass**
### Caching-Based Authorization Bypass
**Rare but real**
**What it is:**  
Shared caches (CDN / proxy) serve privileged content.
**Example:**
- Admin page cached and served to normal users
### Request Smuggling / Response Splitting Bypass
**Rare but real**
**What it is:**  
Shared caches (CDN / proxy) serve privileged content.
**Example:**
- Admin page cached and served to normal users
### State Confusion / Race Condition Authorization Bugs
**Advanced**
**What it is:**  
Authorization depends on timing or inconsistent state.
**Example:**
- Modify role mid-request
- Concurrent requests bypass checks





# Multiple Users
## Burp Autorize Scan
## Nuclei
```
nuclei -u https://target.xyz -tags idor,authz,bac,access-control
```

